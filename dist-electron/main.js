"use strict";const{app:i,BrowserWindow:s,ipcMain:d,shell:a}=require("electron"),t=require("path");require("fs");require("crypto");const{XMLParser:c}=require("fast-xml-parser"),{parseString:h}=require("xml2js");require("jimp");let e;function r(){e=new s({width:1200,height:800,minWidth:800,minHeight:600,webPreferences:{preload:t.join(__dirname,"preload.js"),nodeIntegration:!1,contextIsolation:!0,sandbox:!1},titleBarStyle:"hidden",titleBarOverlay:{color:"#2b2d30",symbolColor:"#ffffff",height:32},icon:t.join(__dirname,"../renderer/assets/icons/icon.png"),show:!1});const o=()=>{const n=process.env.NODE_ENV==="development"?"http://localhost:3000":`file://${t.join(__dirname,"../renderer/dist/index.html")}`;e.loadURL(n).catch(l=>{console.error("Failed to load URL:",l),process.env.NODE_ENV==="development"&&setTimeout(()=>{e.loadURL(`file://${t.join(__dirname,"../renderer/dist/index.html")}`)},1e3)})};e.on("ready-to-show",()=>{e.show(),process.env.NODE_ENV==="development"&&e.webContents.openDevTools({mode:"detach"})}),e.webContents.on("did-fail-load",()=>{console.log("Failed to load content, retrying..."),o()}),o(),e.on("closed",()=>{e=null})}d.handle("encode-base64",(o,n)=>Buffer.from(n).toString("base64"));i.whenReady().then(()=>{r(),i.on("activate",()=>{s.getAllWindows().length===0&&r()})});i.on("window-all-closed",()=>{process.platform!=="darwin"&&i.quit()});if(process.env.NODE_ENV==="development"){const{spawn:o}=require("child_process"),n=o("yarn",["vite"],{stdio:"inherit",shell:!0});process.on("exit",()=>n.kill())}
